<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Simple 2D Avoid‑the‑Blocks Game</title>
<style>
  body { margin:0; background:#111; overflow:hidden; font-family:sans-serif; }
  canvas { display:block; margin:auto; background:#222; }
  #overlay {
    position:absolute; top:10px; left:10px;
    color:#fff; font-size:18px;
    background:rgba(0,0,0,0.5); padding:6px 10px;
    border-radius:4px;
  }
  #homeBtn {
    position:absolute; top:10px; right:10px;
    background:#4aa; color:#fff; border:none;
    padding:6px 12px; font-size:16px;
    border-radius:4px; cursor:pointer;
    background:linear-gradient(45deg,#4aa,#2a8);
    transition:transform 0.1s, box-shadow 0.1s;
  }
  #homeBtn:hover { transform:translateY(-2px); }
  #homeBtn:active { transform:translateY(1px); }
</style>
</head>
<body>

<div id="overlay">Score: 0</div>
<button id="homeBtn">Back to Home</button>
<canvas id="gameCanvas" width="480" height="640"></canvas>

<script>
/* --------------------------------------------------------------
   Tiny 2‑D runner – everything lives in this file.
   No external libraries, pure Canvas API.
-------------------------------------------------------------- */

const canvas = document.getElementById('gameCanvas');
const ctx    = canvas.getContext('2d');

const PLAYER = {
  w: 40,
  h: 40,
  x: canvas.width/2 - 20,
  y: canvas.height - 60,
  speed: 250,   // pixels per second
  color: '#4aa'
};

let blocks = [];          // falling red squares
let lastSpawn = 0;        // time of last block spawn
let spawnInterval = 1200; // ms between spawns (gets faster)
let lastTime = 0;
let score = 0;
let gameOver = false;

// ----------------------------------------------------------------
// Utility helpers
// ----------------------------------------------------------------
function rectsIntersect(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x &&
         a.y < b.y+b.h && a.y+a.h > b.y;
}

// ----------------------------------------------------------------
// Input handling
// ----------------------------------------------------------------
const keys = {};
window.addEventListener('keydown', e=>keys[e.key.toLowerCase()] = true);
window.addEventListener('keyup',   e=>keys[e.key.toLowerCase()] = false);

// ----------------------------------------------------------------
// Main loop
// ----------------------------------------------------------------
function loop(timestamp){
  if(!lastTime) lastTime = timestamp;
  const dt = (timestamp - lastTime) / 1000; // seconds
  lastTime = timestamp;

  if(!gameOver){
    update(dt);
    render();
    requestAnimationFrame(loop);
  }else{
    renderGameOver();
  }
}

// ----------------------------------------------------------------
// Update game state
// ----------------------------------------------------------------
function update(dt){
  // ---- Player movement ----
  if(keys['arrowleft'] || keys['a']) PLAYER.x -= PLAYER.speed * dt;
  if(keys['arrowright']|| keys['d']) PLAYER.x += PLAYER.speed * dt;

  // Keep player inside canvas
  PLAYER.x = Math.max(0, Math.min(canvas.width-PLAYER.w, PLAYER.x));

  // ---- Spawn new blocks ----
  if(lastSpawn===0 || performance.now()-lastSpawn > spawnInterval){
    spawnBlock();
    lastSpawn = performance.now();
    // gradually increase difficulty
    spawnInterval = Math.max(300, spawnInterval - 20);
  }

  // ---- Move existing blocks ----
  for(let i=blocks.length-1; i>=0; i--){
    const b = blocks[i];
    b.y += b.speed * dt;
    // remove off‑screen blocks
    if(b.y > canvas.height) blocks.splice(i,1);
    // collision?
    if(rectsIntersect(PLAYER,b)){
      gameOver = true;
    }
  }

  // ---- Score ----
  score = Math.floor(performance.now()/1000);
  document.getElementById('overlay').textContent = `Score: ${score}`;
}

// ----------------------------------------------------------------
// Render everything
// ----------------------------------------------------------------
function render(){
  // clear
  ctx.fillStyle = '#222';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // player
  ctx.fillStyle = PLAYER.color;
  ctx.fillRect(PLAYER.x, PLAYER.y, PLAYER.w, PLAYER.h);

  // blocks
  ctx.fillStyle = '#c33';
  blocks.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h));
}

// ----------------------------------------------------------------
// Game‑over screen
// ----------------------------------------------------------------
function renderGameOver(){
  render(); // draw last frame
  ctx.fillStyle = 'rgba(0,0,0,0.7)';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = '#fff';
  ctx.font = 'bold 36px sans-serif';
  ctx.textAlign = 'center';
  ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 20);
  ctx.font = '24px sans-serif';
  ctx.fillText(`Your score: ${score}`, canvas.width/2, canvas.height/2 + 20);
}

// ----------------------------------------------------------------
// Spawn a single falling block
// ----------------------------------------------------------------
function spawnBlock(){
  const size = 30 + Math.random()*20; // random size 30‑50px
  const xPos = Math.random() * (canvas.width - size);
  const speed = 150 + Math.random()*100; // 150‑250 px/s
  blocks.push({x:xPos, y:-size, w:size, h:size, speed});
}

// ----------------------------------------------------------------
// Kick‑off
// ----------------------------------------------------------------
requestAnimationFrame(loop);

// ----------------------------------------------------------------
// Home button – simple navigation
// ----------------------------------------------------------------
document.getElementById('homeBtn').addEventListener('click', ()=>{
  window.location.href = 'index.html';
});
</script>
</body>
</html>
